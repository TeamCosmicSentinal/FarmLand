{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sonuj\\\\Downloads\\\\AgroGuru\\\\frontend\\\\src\\\\components\\\\Chatbot.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { askChatbot } from '../api/api';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Chatbot() {\n  _s();\n  const [messages, setMessages] = useState(() => {\n    // Persist conversation in localStorage\n    const saved = localStorage.getItem('chatbot_msgs');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    localStorage.setItem('chatbot_msgs', JSON.stringify(messages));\n    if (messagesEndRef.current) messagesEndRef.current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n  const handleSend = async e => {\n    e.preventDefault();\n    if (!input.trim()) return;\n    setMessages([...messages, {\n      from: 'user',\n      text: input\n    }]);\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await askChatbot({\n        message: input,\n        language: 'hi'\n      });\n      setMessages(msgs => [...msgs, {\n        from: 'bot',\n        text: res.data.answer\n      }]);\n    } catch (err) {\n      setError('Chatbot error');\n      toast.error('Chatbot error. Please try again.');\n    } finally {\n      setLoading(false);\n      setInput('');\n    }\n  };\n  const handleDownload = () => {\n    // Placeholder: Download chat as text file\n    const text = messages.map(m => `${m.from === 'user' ? 'You' : 'Bot'}: ${m.text}`).join('\\n');\n    const blob = new Blob([text], {\n      type: 'text/plain'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'chatbot_conversation.txt';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-card p-4 rounded-xl shadow-lg max-w-xl mx-auto mt-8 text-gray-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-accent\",\n        children: \"AgriGuru Chatbot\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleDownload,\n        className: \"text-xs bg-primary hover:bg-primary-dark text-white px-3 py-1 rounded transition\",\n        children: \"Download Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"h-64 overflow-y-auto border border-background-light p-3 mb-3 bg-background rounded-lg flex flex-col gap-2\",\n      children: [messages.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-gray-400 text-center\",\n        children: \"Start the conversation!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 35\n      }, this), messages.map((msg, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex ${msg.from === 'user' ? 'justify-end' : 'justify-start'}`,\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: `px-4 py-2 rounded-2xl max-w-[70%] break-words shadow ${msg.from === 'user' ? 'bg-primary text-white' : 'bg-card border border-background-light text-accent'}`,\n          children: msg.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 11\n      }, this)), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-start\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"px-4 py-2 rounded-2xl bg-card border border-background-light text-accent animate-pulse\",\n          children: \"Typing...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-red-400 mb-2\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSend,\n      className: \"flex gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"border border-background-light bg-background text-gray-100 p-2 flex-1 rounded focus:outline-none focus:border-accent\",\n        value: input,\n        onChange: e => setInput(e.target.value),\n        placeholder: \"Ask a question (Hindi supported)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"bg-primary hover:bg-primary-dark text-white p-2 rounded transition\",\n        type: \"submit\",\n        disabled: loading,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this);\n}\n_s(Chatbot, \"Ec05acEvXPvhqUlRCBp+onJayk8=\");\n_c = Chatbot;\nexport default Chatbot;\nvar _c;\n$RefreshReg$(_c, \"Chatbot\");","map":{"version":3,"names":["React","useState","useRef","useEffect","askChatbot","toast","jsxDEV","_jsxDEV","Chatbot","_s","messages","setMessages","saved","localStorage","getItem","JSON","parse","input","setInput","loading","setLoading","error","setError","messagesEndRef","setItem","stringify","current","scrollIntoView","behavior","handleSend","e","preventDefault","trim","from","text","res","message","language","msgs","data","answer","err","handleDownload","map","m","join","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","length","msg","i","ref","onSubmit","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["C:/Users/sonuj/Downloads/AgroGuru/frontend/src/components/Chatbot.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { askChatbot } from '../api/api';\nimport { toast } from 'react-toastify';\n\nfunction Chatbot() {\n  const [messages, setMessages] = useState(() => {\n    // Persist conversation in localStorage\n    const saved = localStorage.getItem('chatbot_msgs');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    localStorage.setItem('chatbot_msgs', JSON.stringify(messages));\n    if (messagesEndRef.current) messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  const handleSend = async (e) => {\n    e.preventDefault();\n    if (!input.trim()) return;\n    setMessages([...messages, { from: 'user', text: input }]);\n    setLoading(true); setError(null);\n    try {\n      const res = await askChatbot({ message: input, language: 'hi' });\n      setMessages(msgs => [...msgs, { from: 'bot', text: res.data.answer }]);\n    } catch (err) {\n      setError('Chatbot error');\n      toast.error('Chatbot error. Please try again.');\n    } finally {\n      setLoading(false);\n      setInput('');\n    }\n  };\n\n  const handleDownload = () => {\n    // Placeholder: Download chat as text file\n    const text = messages.map(m => `${m.from === 'user' ? 'You' : 'Bot'}: ${m.text}`).join('\\n');\n    const blob = new Blob([text], { type: 'text/plain' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'chatbot_conversation.txt';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div className=\"bg-card p-4 rounded-xl shadow-lg max-w-xl mx-auto mt-8 text-gray-100\">\n      <div className=\"flex items-center justify-between mb-2\">\n        <h2 className=\"text-2xl font-bold text-accent\">AgriGuru Chatbot</h2>\n        <button onClick={handleDownload} className=\"text-xs bg-primary hover:bg-primary-dark text-white px-3 py-1 rounded transition\">Download Chat</button>\n      </div>\n      <div className=\"h-64 overflow-y-auto border border-background-light p-3 mb-3 bg-background rounded-lg flex flex-col gap-2\">\n        {messages.length === 0 && <div className=\"text-gray-400 text-center\">Start the conversation!</div>}\n        {messages.map((msg, i) => (\n          <div key={i} className={`flex ${msg.from === 'user' ? 'justify-end' : 'justify-start'}`}> \n            <span className={`px-4 py-2 rounded-2xl max-w-[70%] break-words shadow ${msg.from === 'user' ? 'bg-primary text-white' : 'bg-card border border-background-light text-accent'}`}>{msg.text}</span>\n          </div>\n        ))}\n        {loading && (\n          <div className=\"flex justify-start\">\n            <span className=\"px-4 py-2 rounded-2xl bg-card border border-background-light text-accent animate-pulse\">Typing...</span>\n          </div>\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n      {error && <div className=\"text-red-400 mb-2\">{error}</div>}\n      <form onSubmit={handleSend} className=\"flex gap-2\">\n        <input className=\"border border-background-light bg-background text-gray-100 p-2 flex-1 rounded focus:outline-none focus:border-accent\" value={input} onChange={e => setInput(e.target.value)} placeholder=\"Ask a question (Hindi supported)\" />\n        <button className=\"bg-primary hover:bg-primary-dark text-white p-2 rounded transition\" type=\"submit\" disabled={loading}>Send</button>\n      </form>\n    </div>\n  );\n}\nexport default Chatbot;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}